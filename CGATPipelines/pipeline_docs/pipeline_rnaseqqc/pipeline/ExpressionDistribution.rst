.. _ExpressionDistribution:

==================================
Distributions of Expression values
==================================

Summary
=======

Aims
----

Comparing the distribution of expression levels between samples can
highlight anomalous samples that might need excluding from downstream analysis.  


Inputs
------

A table of expression values in transcripts per million (TPM) for each 
transcript and samples generated by Sailfish and stored as 
"transcript_quantification" in the pipeline database.


Outputs
-------

A density plot showing detection of all transcripts with intensity of
expression presented on the x-axis as log2TPM.  Each line represents a
different sample.


How the results are generated
-----------------------------

1. Sample_ID, transcript_ID and TPM are extracted from the 
   "transcript_quantification" table in the pipeline database and
   entered into a dataframe
2. TPM values are log transformed, log2(TPM_count + c), where c is
   a user-defined constant eg. 0.1, 1
3. A density plot is produced using the geom_density function from
   ggplot2

What you should expect
----------------------

Typically you will see a spike at ~0 log2TPM representing non-
expressed or very lowly expressed transcripts and then roughly
normally distributed expressed genes


Examples
--------

  * Good example
  * Bad example
  * Links to other examples and the reasons that lie behind them

The good

.. report:: GoodExample.Tracker
   :render: myRenderer
   :transform: myTransform
   :options: myAesthetics


The bad

.. report:: BadExample.Tracker
   :render: myRenderer
   :transform: myTransform
   :options: myAesthetics


More bad examples `<http://myBadData.html >`


Expression Distribution plot
============================

.. report:: RnaseqqcReport.ExpressionDistribution
   :render: r-ggplot
   :statement: aes(x=logTPM, group=sample_id, colour=as.factor(sample_id))+
               geom_density()

Commentary
  This will take the form of some active comments.  This will require the report to
  be published so that it is hosted on the CGAT server/ comments on the DISQUS server.
